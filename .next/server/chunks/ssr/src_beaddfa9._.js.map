{"version":3,"sources":["../../../../src/components/PlaceholderImage.tsx","../../../../src/lib/placehold.ts","../../../../src/hooks/useAudio.ts","../../../../src/components/mixtapes/MixtapePlayButton.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState } from \"react\";\nimport Image from \"next/image\";\nimport { buildPlaceholdUrl } from \"../lib/placehold\";\n\ntype PlaceholderImageProps = {\n  src?: string | null | undefined;\n  alt: string;\n  width: number;\n  height: number;\n  placeholderText?: string | undefined;\n  className?: string | undefined;\n  fill?: boolean | undefined;\n  objectFit?: \"cover\" | \"contain\" | undefined;\n};\n\n/**\n * Wrapper around Next.js Image that falls back to placehold.co if src is missing/invalid.\n * Falls back to placeholder if src is undefined, null, or empty string.\n */\nexport default function PlaceholderImage({\n  src,\n  alt,\n  width,\n  height,\n  placeholderText,\n  className,\n  fill,\n  objectFit = \"cover\",\n}: PlaceholderImageProps) {\n  const [imgError, setImgError] = useState(false);\n\n  // Use placeholder if src is missing or if image failed to load\n  const usePlaceholder = !src || src.trim() === \"\" || imgError;\n\n  const finalSrc = usePlaceholder\n    ? buildPlaceholdUrl({\n        width,\n        height,\n        format: \"svg\",\n        background: \"1a1a1a\",\n        color: \"666666\",\n        text: placeholderText || `${width}x${height}`,\n      })\n    : src;\n\n  if (fill) {\n    return (\n      <Image\n        src={finalSrc}\n        alt={alt}\n        fill\n        className={className}\n        style={{ objectFit }}\n        onError={() => !usePlaceholder && setImgError(true)}\n        unoptimized={usePlaceholder}\n      />\n    );\n  }\n\n  return (\n    <Image\n      src={finalSrc}\n      alt={alt}\n      width={width}\n      height={height}\n      className={className}\n      style={{ objectFit }}\n      onError={() => !usePlaceholder && setImgError(true)}\n      unoptimized={usePlaceholder}\n    />\n  );\n}\n","export type PlaceholdOptions = {\n  width: number;\n  height?: number;\n  format?: \"png\" | \"svg\" | \"jpeg\" | \"jpg\" | \"webp\" | \"avif\" | \"gif\";\n  background?: string; // hex or css name\n  color?: string; // text color\n  text?: string;\n  font?: string;\n  retina?: 2 | 3;\n};\n\nconst DEFAULT_BG = \"EEE\";\nconst DEFAULT_FG = \"31343C\";\n\n/**\n * Build a placehold.co URL with given dimensions and options.\n * Safe to use in both client and server contexts.\n */\nexport function buildPlaceholdUrl(opts: PlaceholdOptions): string {\n  const width = Math.max(10, Math.min(4000, Math.floor(opts.width)));\n  const height = opts.height ? Math.max(10, Math.min(4000, Math.floor(opts.height))) : undefined;\n  const size = height ? `${width}x${height}` : `${width}`;\n\n  const format = opts.format ?? \"png\";\n  const bg = opts.background ?? DEFAULT_BG;\n  const fg = opts.color ?? DEFAULT_FG;\n\n  // base path like /600x400/000/FFF.png\n  const extPart = `.${format}`;\n  const colorPart = `${encodeURIComponent(String(bg))}/${encodeURIComponent(String(fg))}`;\n\n  let url = `https://placehold.co/${size}/${colorPart}${extPart}`;\n\n  const qs = new URLSearchParams();\n  if (opts.text) qs.set(\"text\", String(opts.text));\n  if (opts.font) qs.set(\"font\", String(opts.font));\n  if (opts.retina && (format !== \"svg\")) qs.set(\"@\", `${opts.retina}x`);\n\n  const q = qs.toString();\n  if (q) url += `?${q}`;\n\n  return url;\n}\n\nexport default {\n  buildPlaceholdUrl,\n};\n","\"use client\";\n\nimport { useInternalAudio, Track } from \"../components/audio/AudioProvider\";\n\nexport default function useAudio() {\n  const ctx = useInternalAudio();\n\n  // convenience: play release object\n  const playRelease = (release: { preview_url?: string | null; title?: string; artist?: string; id?: string }) => {\n    if (!release?.preview_url) return;\n    const track: Track = {\n      id: release.id,\n      url: release.preview_url,\n      title: release.title,\n      artist: release.artist,\n      source: release.id,\n    };\n    ctx.playTrack(track);\n  };\n\n  const playMixtape = (mixtape: { embed_url?: string | null; title?: string; artist?: string; id?: string }) => {\n    // If there's a direct preview URL, use it. Otherwise use embed if allowed.\n    if (mixtape?.embed_url) {\n      const track: Track = {\n        id: mixtape.id,\n        url: mixtape.embed_url,\n        title: mixtape.title,\n        artist: mixtape.artist,\n        source: mixtape.id,\n      };\n      ctx.playTrack(track);\n    }\n  };\n\n  return {\n    ...ctx,\n    playRelease,\n    playMixtape,\n  };\n}\n","\"use client\";\n\nimport React, { useState } from \"react\";\nimport useAudio from \"../../hooks/useAudio\";\n\nexport default function MixtapePlayButton({\n  embedUrl,\n  title,\n  id,\n  artist,\n}: {\n  embedUrl?: string | null;\n  title?: string;\n  id?: string;\n  artist?: string;\n}) {\n  const audio = useAudio();\n  const [open, setOpen] = useState(false);\n\n  const isDirectAudio = (u?: string | null) => {\n    if (!u) return false;\n    return /\\.(mp3|wav|ogg|m4a)(\\?.*)?$/i.test(u);\n  };\n\n  const onPlay = () => {\n    if (!embedUrl) return;\n    if (isDirectAudio(embedUrl)) {\n      audio.playMixtape({ embed_url: embedUrl, title: title ?? \"Mixtape\", artist: artist ?? \"SIGIL.ZERO\", id: id ?? \"mixtape\" });\n    } else {\n      // open iframe modal to let the embed control playback\n      setOpen(true);\n    }\n  };\n\n  return (\n    <div className=\"mb-4\">\n      <button onClick={onPlay} className=\"px-3 py-2 bg-white text-black rounded mr-3\">\n        â–¶ Play Mixtape\n      </button>\n\n      {open && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/70\">\n          <div className=\"w-full max-w-3xl bg-black border border-gray-800 rounded p-4\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <div className=\"text-sm font-semibold text-white\">{title}</div>\n              <button onClick={() => setOpen(false)} className=\"text-gray-300\">Close</button>\n            </div>\n            <div className=\"w-full aspect-video\">\n              <iframe src={embedUrl ?? \"\"} title={title} className=\"w-full h-full border-0\" allow=\"autoplay\" />\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}